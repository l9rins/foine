{"ast":null,"code":"import _objectSpread from\"C:/Users/Mark Lorenz/Desktop/Foine/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback}from'react';import axios from'axios';import Header from'./Header';import Hero from'./Hero';import MasonryGrid from'./MasonryGrid';import Modals from'./Modals';import UploadModal from'./UploadModal';import ImageModal from'./ImageModal';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_BASE='http://localhost:8080/api';function Home(){const[user,setUser]=useState(null);const[posts,setPosts]=useState([]);const[modalState,setModalState]=useState({isOpen:false,type:'login'});const[showUpload,setShowUpload]=useState(false);const[selectedPost,setSelectedPost]=useState(null);const[showImageModal,setShowImageModal]=useState(false);const[searchQuery,setSearchQuery]=useState('');const[loading,setLoading]=useState(true);const[hasMore,setHasMore]=useState(true);const[currentPage,setCurrentPage]=useState(0);const fetchPosts=useCallback(async function(){let page=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;let append=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(page===0){setLoading(true);}try{const res=await axios.get(\"\".concat(API_BASE,\"/posts\"),{params:{page,size:12}});// Process posts with like/save status\nlet postsWithStatus=res.data.content;if(user){postsWithStatus=await Promise.all(res.data.content.map(async post=>{try{const[likedRes,savedRes,countRes]=await Promise.all([axios.get(\"\".concat(API_BASE,\"/posts/\").concat(post.id,\"/liked\"),{params:{userId:user.id}}),axios.get(\"\".concat(API_BASE,\"/posts/\").concat(post.id,\"/saved\"),{params:{userId:user.id}}),axios.get(\"\".concat(API_BASE,\"/posts/\").concat(post.id,\"/likes/count\"))]);return _objectSpread(_objectSpread({},post),{},{isLiked:likedRes.data,isSaved:savedRes.data,likesCount:countRes.data});}catch(err){console.error(\"Error fetching status for post \".concat(post.id,\":\"),err);return _objectSpread(_objectSpread({},post),{},{isLiked:false,isSaved:false,likesCount:0});}}));}else{// If no user, set default status\npostsWithStatus=res.data.content.map(post=>_objectSpread(_objectSpread({},post),{},{isLiked:false,isSaved:false,likesCount:0}));}if(append){setPosts(prevPosts=>[...prevPosts,...postsWithStatus]);}else{setPosts(postsWithStatus);}setHasMore(!res.data.last);setCurrentPage(page);}catch(err){console.error(\"Error fetching posts:\",err);}finally{setLoading(false);}},[user]);const handleSearch=async query=>{if(!query.trim()){setSearchQuery('');fetchPosts(0,false);return;}setSearchQuery(query);setLoading(true);try{const res=await axios.get(\"\".concat(API_BASE,\"/posts/search\"),{params:{query:query.trim(),page:0,size:12}});// If user is logged in, fetch liked/saved status for each post\nlet postsWithStatus=res.data.content;if(user){postsWithStatus=await Promise.all(res.data.content.map(async post=>{try{const[likedRes,savedRes,countRes]=await Promise.all([axios.get(\"\".concat(API_BASE,\"/posts/\").concat(post.id,\"/liked\"),{params:{userId:user.id}}),axios.get(\"\".concat(API_BASE,\"/posts/\").concat(post.id,\"/saved\"),{params:{userId:user.id}}),axios.get(\"\".concat(API_BASE,\"/posts/\").concat(post.id,\"/likes/count\"))]);return _objectSpread(_objectSpread({},post),{},{isLiked:likedRes.data,isSaved:savedRes.data,likesCount:countRes.data});}catch(err){console.error(\"Error fetching status for post \".concat(post.id,\":\"),err);return _objectSpread(_objectSpread({},post),{},{isLiked:false,isSaved:false,likesCount:0});}}));}else{// If no user, set default status\npostsWithStatus=res.data.content.map(post=>_objectSpread(_objectSpread({},post),{},{isLiked:false,isSaved:false,likesCount:0}));}setPosts(postsWithStatus);setHasMore(!res.data.last);setCurrentPage(0);}catch(err){console.error(\"Error searching posts:\",err.message);// If search fails, fall back to all posts\nfetchPosts(0,false);}finally{setLoading(false);}};const fetchMorePosts=useCallback(async()=>{if(hasMore&&!loading){const nextPage=currentPage+1;if(searchQuery){// Fetch more search results\ntry{const res=await axios.get(\"\".concat(API_BASE,\"/posts/search\"),{params:{query:searchQuery,page:nextPage,size:12}});// Process posts with like/save status\nlet postsWithStatus=res.data.content;if(user){postsWithStatus=await Promise.all(res.data.content.map(async post=>{try{const[likedRes,savedRes,countRes]=await Promise.all([axios.get(\"\".concat(API_BASE,\"/posts/\").concat(post.id,\"/liked\"),{params:{userId:user.id}}),axios.get(\"\".concat(API_BASE,\"/posts/\").concat(post.id,\"/saved\"),{params:{userId:user.id}}),axios.get(\"\".concat(API_BASE,\"/posts/\").concat(post.id,\"/likes/count\"))]);return _objectSpread(_objectSpread({},post),{},{isLiked:likedRes.data,isSaved:savedRes.data,likesCount:countRes.data});}catch(err){console.error(\"Error fetching status for post \".concat(post.id,\":\"),err);return _objectSpread(_objectSpread({},post),{},{isLiked:false,isSaved:false,likesCount:0});}}));}else{// If no user, set default status\npostsWithStatus=res.data.content.map(post=>_objectSpread(_objectSpread({},post),{},{isLiked:false,isSaved:false,likesCount:0}));}setPosts(prevPosts=>[...prevPosts,...postsWithStatus]);setHasMore(!res.data.last);setCurrentPage(nextPage);}catch(err){console.error(\"Error fetching more search results:\",err);}}else{// Fetch more regular posts\nfetchPosts(nextPage,true);}}},[hasMore,loading,currentPage,searchQuery,user,fetchPosts]);useEffect(()=>{// Load user from localStorage first\nconst storedUserId=localStorage.getItem('userId');if(storedUserId){setUser({id:parseInt(storedUserId)});}else{// Force login if no user\nsetModalState({isOpen:true,type:'login'});}},[]);// Empty dependency array - only run once on mount\nuseEffect(()=>{// Fetch posts when user state changes\nfetchPosts();},[user]);// Only depend on user, not fetchPosts\nconst handleLogin=async(email,password)=>{try{const res=await axios.post(\"\".concat(API_BASE,\"/login\"),{email,password});// For simplicity, store user id in localStorage\nlocalStorage.setItem('userId',res.data.userId);setUser({id:res.data.userId,email:res.data.email});setModalState({isOpen:false,type:'login'});// Refetch posts to get liked/saved status\nfetchPosts();}catch(err){var _err$response;alert('Login failed: '+(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message));}};const handleRegister=async userData=>{try{await axios.post(\"\".concat(API_BASE,\"/register\"),userData);alert('Registered successfully');setModalState({isOpen:false,type:'login'});}catch(err){var _err$response2,_err$response3,_err$response4;let errorMsg='Registration failed';if((_err$response2=err.response)!==null&&_err$response2!==void 0&&_err$response2.data){// Handle both string and object responses\nif(typeof err.response.data==='string'){errorMsg+=': '+err.response.data;}else if(err.response.data.error){errorMsg+=': '+err.response.data.error;}else if(err.response.data.message){errorMsg+=': '+err.response.data.message;}}else if(((_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.status)===400){var _err$response$data;errorMsg=((_err$response$data=err.response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||'Bad request';}else if(((_err$response4=err.response)===null||_err$response4===void 0?void 0:_err$response4.status)===500){var _err$response$data2;errorMsg='Server error - '+(((_err$response$data2=err.response.data)===null||_err$response$data2===void 0?void 0:_err$response$data2.error)||'Check backend logs');}else if(err.code==='ECONNABORTED'){errorMsg='Upload timeout - File too large or slow connection';}alert(errorMsg);}};const handleUpload=async formData=>{try{await axios.post(\"\".concat(API_BASE,\"/posts/upload\"),formData,{headers:{'Content-Type':'multipart/form-data'},timeout:30000// 30 seconds timeout\n});alert('Post uploaded successfully!');setShowUpload(false);// Refresh posts\nfetchPosts();}catch(err){var _err$response5,_err$response6,_err$response7;let errorMsg='Upload failed';if((_err$response5=err.response)!==null&&_err$response5!==void 0&&_err$response5.data){// Handle both string and object responses\nif(typeof err.response.data==='string'){errorMsg+=': '+err.response.data;}else if(err.response.data.error){errorMsg+=': '+err.response.data.error;}else if(err.response.data.message){errorMsg+=': '+err.response.data.message;}}else if(((_err$response6=err.response)===null||_err$response6===void 0?void 0:_err$response6.status)===400){var _err$response$data3;errorMsg=((_err$response$data3=err.response.data)===null||_err$response$data3===void 0?void 0:_err$response$data3.error)||'Bad request';}else if(((_err$response7=err.response)===null||_err$response7===void 0?void 0:_err$response7.status)===500){var _err$response$data4;errorMsg='Server error - '+(((_err$response$data4=err.response.data)===null||_err$response$data4===void 0?void 0:_err$response$data4.error)||'Check backend logs');}else if(err.code==='ECONNABORTED'){errorMsg='Upload timeout - File too large or slow connection';}alert(errorMsg);}};const handleLike=async postId=>{if(!user){setModalState({isOpen:true,type:'login'});return;}try{await axios.post(\"\".concat(API_BASE,\"/posts/\").concat(postId,\"/like\"),{userId:user.id});// Update the post's liked status in state\nsetPosts(prevPosts=>prevPosts.map(post=>post.id===postId?_objectSpread(_objectSpread({},post),{},{isLiked:!post.isLiked}):post));}catch(err){console.error('Error toggling like:',err);alert('Failed to toggle like');}};const handleSave=async postId=>{if(!user){setModalState({isOpen:true,type:'login'});return;}try{await axios.post(\"\".concat(API_BASE,\"/posts/\").concat(postId,\"/save\"),{userId:user.id});// Update the post's saved status in state\nsetPosts(prevPosts=>prevPosts.map(post=>post.id===postId?_objectSpread(_objectSpread({},post),{},{isSaved:!post.isSaved}):post));}catch(err){console.error('Error toggling save:',err);alert('Failed to toggle save');}};const handleShare=post=>{if(navigator.share){navigator.share({title:post.title,text:post.description,url:window.location.href});}else{// Fallback: copy to clipboard\nnavigator.clipboard.writeText(window.location.href);alert('Link copied to clipboard!');}};const handleImageClick=post=>{setSelectedPost(post);setShowImageModal(true);};const handleCloseImageModal=()=>{setShowImageModal(false);setSelectedPost(null);};const handleDeletePost=async postId=>{if(!window.confirm('Are you sure you want to delete this post?'))return;try{await axios.delete(\"\".concat(API_BASE,\"/posts/\").concat(postId));setPosts(prevPosts=>prevPosts.filter(post=>post.id!==postId));setShowImageModal(false);setSelectedPost(null);alert('Post deleted successfully');}catch(err){console.error('Error deleting post:',err);alert('Failed to delete post');}};const handleGetStarted=()=>{if(user){// Scroll to grid or something\n}else{setModalState({isOpen:true,type:'register'});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-background\",children:[/*#__PURE__*/_jsx(Header,{user:user,searchQuery:searchQuery,onSearch:handleSearch,onUploadClick:()=>setShowUpload(true),onLogout:()=>{setUser(null);localStorage.removeItem('userId');setSearchQuery('');setCurrentPage(0);setHasMore(true);fetchPosts(0,false);// Reset to all posts on logout\n},onLoginClick:()=>setModalState({isOpen:true,type:'login'}),onRegisterClick:()=>setModalState({isOpen:true,type:'register'})}),!user?/*#__PURE__*/_jsx(Hero,{onGetStarted:handleGetStarted}):/*#__PURE__*/_jsx(MasonryGrid,{posts:posts,loading:loading,hasMore:hasMore,fetchMorePosts:fetchMorePosts,onLike:handleLike,onSave:handleSave,onShare:handleShare,onImageClick:handleImageClick}),/*#__PURE__*/_jsx(Modals,{isOpen:modalState.isOpen,onClose:()=>setModalState({isOpen:false,type:modalState.type}),type:modalState.type,onSwitchType:type=>setModalState({isOpen:true,type}),onLogin:handleLogin,onRegister:handleRegister}),/*#__PURE__*/_jsx(UploadModal,{isOpen:showUpload,onClose:()=>setShowUpload(false),onUpload:handleUpload,user:user}),/*#__PURE__*/_jsx(ImageModal,{post:selectedPost,isOpen:showImageModal,onClose:handleCloseImageModal,onLike:handleLike,onSave:handleSave,onDelete:handleDeletePost,user:user})]});}export default Home;","map":{"version":3,"names":["React","useState","useEffect","useCallback","axios","Header","Hero","MasonryGrid","Modals","UploadModal","ImageModal","jsx","_jsx","jsxs","_jsxs","API_BASE","Home","user","setUser","posts","setPosts","modalState","setModalState","isOpen","type","showUpload","setShowUpload","selectedPost","setSelectedPost","showImageModal","setShowImageModal","searchQuery","setSearchQuery","loading","setLoading","hasMore","setHasMore","currentPage","setCurrentPage","fetchPosts","page","arguments","length","undefined","append","res","get","concat","params","size","postsWithStatus","data","content","Promise","all","map","post","likedRes","savedRes","countRes","id","userId","_objectSpread","isLiked","isSaved","likesCount","err","console","error","prevPosts","last","handleSearch","query","trim","message","fetchMorePosts","nextPage","storedUserId","localStorage","getItem","parseInt","handleLogin","email","password","setItem","_err$response","alert","response","handleRegister","userData","_err$response2","_err$response3","_err$response4","errorMsg","status","_err$response$data","_err$response$data2","code","handleUpload","formData","headers","timeout","_err$response5","_err$response6","_err$response7","_err$response$data3","_err$response$data4","handleLike","postId","handleSave","handleShare","navigator","share","title","text","description","url","window","location","href","clipboard","writeText","handleImageClick","handleCloseImageModal","handleDeletePost","confirm","delete","filter","handleGetStarted","className","children","onSearch","onUploadClick","onLogout","removeItem","onLoginClick","onRegisterClick","onGetStarted","onLike","onSave","onShare","onImageClick","onClose","onSwitchType","onLogin","onRegister","onUpload","onDelete"],"sources":["C:/Users/Mark Lorenz/Desktop/Foine/frontend/src/components/Home.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport axios from 'axios';\r\nimport Header from './Header';\r\nimport Hero from './Hero';\r\nimport MasonryGrid from './MasonryGrid';\r\nimport Modals from './Modals';\r\nimport UploadModal from './UploadModal';\r\nimport ImageModal from './ImageModal';\r\n\r\nconst API_BASE = 'http://localhost:8080/api';\r\n\r\nfunction Home() {\r\n  const [user, setUser] = useState(null);\r\n  const [posts, setPosts] = useState([]);\r\n  const [modalState, setModalState] = useState({ isOpen: false, type: 'login' });\r\n  const [showUpload, setShowUpload] = useState(false);\r\n  const [selectedPost, setSelectedPost] = useState(null);\r\n  const [showImageModal, setShowImageModal] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [hasMore, setHasMore] = useState(true);\r\n  const [currentPage, setCurrentPage] = useState(0);\r\n\r\n  const fetchPosts = useCallback(async (page = 0, append = false) => {\r\n    if (page === 0) {\r\n      setLoading(true);\r\n    }\r\n    try {\r\n      const res = await axios.get(`${API_BASE}/posts`, {\r\n        params: { page, size: 12 }\r\n      });\r\n\r\n      // Process posts with like/save status\r\n      let postsWithStatus = res.data.content;\r\n      if (user) {\r\n        postsWithStatus = await Promise.all(\r\n          res.data.content.map(async (post) => {\r\n            try {\r\n              const [likedRes, savedRes, countRes] = await Promise.all([\r\n                axios.get(`${API_BASE}/posts/${post.id}/liked`, { params: { userId: user.id } }),\r\n                axios.get(`${API_BASE}/posts/${post.id}/saved`, { params: { userId: user.id } }),\r\n                axios.get(`${API_BASE}/posts/${post.id}/likes/count`)\r\n              ]);\r\n              return {\r\n                ...post,\r\n                isLiked: likedRes.data,\r\n                isSaved: savedRes.data,\r\n                likesCount: countRes.data\r\n              };\r\n            } catch (err) {\r\n              console.error(`Error fetching status for post ${post.id}:`, err);\r\n              return {\r\n                ...post,\r\n                isLiked: false,\r\n                isSaved: false,\r\n                likesCount: 0\r\n              };\r\n            }\r\n          })\r\n        );\r\n      } else {\r\n        // If no user, set default status\r\n        postsWithStatus = res.data.content.map(post => ({\r\n          ...post,\r\n          isLiked: false,\r\n          isSaved: false,\r\n          likesCount: 0\r\n        }));\r\n      }\r\n\r\n      if (append) {\r\n        setPosts(prevPosts => [...prevPosts, ...postsWithStatus]);\r\n      } else {\r\n        setPosts(postsWithStatus);\r\n      }\r\n      setHasMore(!res.data.last);\r\n      setCurrentPage(page);\r\n    } catch (err) {\r\n      console.error(\"Error fetching posts:\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user]);\r\n\r\n  const handleSearch = async (query) => {\r\n    if (!query.trim()) {\r\n      setSearchQuery('');\r\n      fetchPosts(0, false);\r\n      return;\r\n    }\r\n\r\n    setSearchQuery(query);\r\n    setLoading(true);\r\n    try {\r\n      const res = await axios.get(`${API_BASE}/posts/search`, {\r\n        params: { query: query.trim(), page: 0, size: 12 }\r\n      });\r\n\r\n      // If user is logged in, fetch liked/saved status for each post\r\n      let postsWithStatus = res.data.content;\r\n      if (user) {\r\n        postsWithStatus = await Promise.all(\r\n          res.data.content.map(async (post) => {\r\n            try {\r\n              const [likedRes, savedRes, countRes] = await Promise.all([\r\n                axios.get(`${API_BASE}/posts/${post.id}/liked`, { params: { userId: user.id } }),\r\n                axios.get(`${API_BASE}/posts/${post.id}/saved`, { params: { userId: user.id } }),\r\n                axios.get(`${API_BASE}/posts/${post.id}/likes/count`)\r\n              ]);\r\n              return {\r\n                ...post,\r\n                isLiked: likedRes.data,\r\n                isSaved: savedRes.data,\r\n                likesCount: countRes.data\r\n              };\r\n            } catch (err) {\r\n              console.error(`Error fetching status for post ${post.id}:`, err);\r\n              return {\r\n                ...post,\r\n                isLiked: false,\r\n                isSaved: false,\r\n                likesCount: 0\r\n              };\r\n            }\r\n          })\r\n        );\r\n      } else {\r\n        // If no user, set default status\r\n        postsWithStatus = res.data.content.map(post => ({\r\n          ...post,\r\n          isLiked: false,\r\n          isSaved: false,\r\n          likesCount: 0\r\n        }));\r\n      }\r\n\r\n      setPosts(postsWithStatus);\r\n      setHasMore(!res.data.last);\r\n      setCurrentPage(0);\r\n    } catch (err) {\r\n      console.error(\"Error searching posts:\", err.message);\r\n      // If search fails, fall back to all posts\r\n      fetchPosts(0, false);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchMorePosts = useCallback(async () => {\r\n    if (hasMore && !loading) {\r\n      const nextPage = currentPage + 1;\r\n      if (searchQuery) {\r\n        // Fetch more search results\r\n        try {\r\n          const res = await axios.get(`${API_BASE}/posts/search`, {\r\n            params: { query: searchQuery, page: nextPage, size: 12 }\r\n          });\r\n\r\n          // Process posts with like/save status\r\n          let postsWithStatus = res.data.content;\r\n          if (user) {\r\n            postsWithStatus = await Promise.all(\r\n              res.data.content.map(async (post) => {\r\n                try {\r\n                  const [likedRes, savedRes, countRes] = await Promise.all([\r\n                    axios.get(`${API_BASE}/posts/${post.id}/liked`, { params: { userId: user.id } }),\r\n                    axios.get(`${API_BASE}/posts/${post.id}/saved`, { params: { userId: user.id } }),\r\n                    axios.get(`${API_BASE}/posts/${post.id}/likes/count`)\r\n                  ]);\r\n                  return {\r\n                    ...post,\r\n                    isLiked: likedRes.data,\r\n                    isSaved: savedRes.data,\r\n                    likesCount: countRes.data\r\n                  };\r\n                } catch (err) {\r\n                  console.error(`Error fetching status for post ${post.id}:`, err);\r\n                  return {\r\n                    ...post,\r\n                    isLiked: false,\r\n                    isSaved: false,\r\n                    likesCount: 0\r\n                  };\r\n                }\r\n              })\r\n            );\r\n          } else {\r\n            // If no user, set default status\r\n            postsWithStatus = res.data.content.map(post => ({\r\n              ...post,\r\n              isLiked: false,\r\n              isSaved: false,\r\n              likesCount: 0\r\n            }));\r\n          }\r\n\r\n          setPosts(prevPosts => [...prevPosts, ...postsWithStatus]);\r\n          setHasMore(!res.data.last);\r\n          setCurrentPage(nextPage);\r\n        } catch (err) {\r\n          console.error(\"Error fetching more search results:\", err);\r\n        }\r\n      } else {\r\n        // Fetch more regular posts\r\n        fetchPosts(nextPage, true);\r\n      }\r\n    }\r\n  }, [hasMore, loading, currentPage, searchQuery, user, fetchPosts]);\r\n\r\n  useEffect(() => {\r\n    // Load user from localStorage first\r\n    const storedUserId = localStorage.getItem('userId');\r\n    if (storedUserId) {\r\n      setUser({ id: parseInt(storedUserId) });\r\n    } else {\r\n      // Force login if no user\r\n      setModalState({ isOpen: true, type: 'login' });\r\n    }\r\n  }, []); // Empty dependency array - only run once on mount\r\n\r\n  useEffect(() => {\r\n    // Fetch posts when user state changes\r\n    fetchPosts();\r\n  }, [user]); // Only depend on user, not fetchPosts\r\n\r\n  const handleLogin = async (email, password) => {\r\n    try {\r\n      const res = await axios.post(`${API_BASE}/login`, { email, password });\r\n      // For simplicity, store user id in localStorage\r\n      localStorage.setItem('userId', res.data.userId);\r\n      setUser({ id: res.data.userId, email: res.data.email });\r\n      setModalState({ isOpen: false, type: 'login' });\r\n\r\n      // Refetch posts to get liked/saved status\r\n      fetchPosts();\r\n    } catch (err) {\r\n      alert('Login failed: ' + (err.response?.data || err.message));\r\n    }\r\n  };\r\n\r\n  const handleRegister = async (userData) => {\r\n    try {\r\n      await axios.post(`${API_BASE}/register`, userData);\r\n      alert('Registered successfully');\r\n      setModalState({ isOpen: false, type: 'login' });\r\n    } catch (err) {\r\n      let errorMsg = 'Registration failed';\r\n      if (err.response?.data) {\r\n        // Handle both string and object responses\r\n        if (typeof err.response.data === 'string') {\r\n          errorMsg += ': ' + err.response.data;\r\n        } else if (err.response.data.error) {\r\n          errorMsg += ': ' + err.response.data.error;\r\n        } else if (err.response.data.message) {\r\n          errorMsg += ': ' + err.response.data.message;\r\n        }\r\n      } else if (err.response?.status === 400) {\r\n        errorMsg = err.response.data?.error || 'Bad request';\r\n      } else if (err.response?.status === 500) {\r\n        errorMsg = 'Server error - ' + (err.response.data?.error || 'Check backend logs');\r\n      } else if (err.code === 'ECONNABORTED') {\r\n        errorMsg = 'Upload timeout - File too large or slow connection';\r\n      }\r\n\r\n      alert(errorMsg);\r\n    }\r\n  };\r\n\r\n  const handleUpload = async (formData) => {\r\n    try {\r\n      await axios.post(`${API_BASE}/posts/upload`, formData, {\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data',\r\n        },\r\n        timeout: 30000, // 30 seconds timeout\r\n      });\r\n\r\n      alert('Post uploaded successfully!');\r\n      setShowUpload(false);\r\n      // Refresh posts\r\n      fetchPosts();\r\n    } catch (err) {\r\n      let errorMsg = 'Upload failed';\r\n      if (err.response?.data) {\r\n        // Handle both string and object responses\r\n        if (typeof err.response.data === 'string') {\r\n          errorMsg += ': ' + err.response.data;\r\n        } else if (err.response.data.error) {\r\n          errorMsg += ': ' + err.response.data.error;\r\n        } else if (err.response.data.message) {\r\n          errorMsg += ': ' + err.response.data.message;\r\n        }\r\n      } else if (err.response?.status === 400) {\r\n        errorMsg = err.response.data?.error || 'Bad request';\r\n      } else if (err.response?.status === 500) {\r\n        errorMsg = 'Server error - ' + (err.response.data?.error || 'Check backend logs');\r\n      } else if (err.code === 'ECONNABORTED') {\r\n        errorMsg = 'Upload timeout - File too large or slow connection';\r\n      }\r\n\r\n      alert(errorMsg);\r\n    }\r\n  };\r\n\r\n  const handleLike = async (postId) => {\r\n    if (!user) {\r\n      setModalState({ isOpen: true, type: 'login' });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await axios.post(`${API_BASE}/posts/${postId}/like`, { userId: user.id });\r\n\r\n      // Update the post's liked status in state\r\n      setPosts(prevPosts =>\r\n        prevPosts.map(post =>\r\n          post.id === postId\r\n            ? { ...post, isLiked: !post.isLiked }\r\n            : post\r\n        )\r\n      );\r\n    } catch (err) {\r\n      console.error('Error toggling like:', err);\r\n      alert('Failed to toggle like');\r\n    }\r\n  };\r\n\r\n  const handleSave = async (postId) => {\r\n    if (!user) {\r\n      setModalState({ isOpen: true, type: 'login' });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await axios.post(`${API_BASE}/posts/${postId}/save`, { userId: user.id });\r\n\r\n      // Update the post's saved status in state\r\n      setPosts(prevPosts =>\r\n        prevPosts.map(post =>\r\n          post.id === postId\r\n            ? { ...post, isSaved: !post.isSaved }\r\n            : post\r\n        )\r\n      );\r\n    } catch (err) {\r\n      console.error('Error toggling save:', err);\r\n      alert('Failed to toggle save');\r\n    }\r\n  };\r\n\r\n  const handleShare = (post) => {\r\n    if (navigator.share) {\r\n      navigator.share({\r\n        title: post.title,\r\n        text: post.description,\r\n        url: window.location.href,\r\n      });\r\n    } else {\r\n      // Fallback: copy to clipboard\r\n      navigator.clipboard.writeText(window.location.href);\r\n      alert('Link copied to clipboard!');\r\n    }\r\n  };\r\n\r\n  const handleImageClick = (post) => {\r\n    setSelectedPost(post);\r\n    setShowImageModal(true);\r\n  };\r\n\r\n  const handleCloseImageModal = () => {\r\n    setShowImageModal(false);\r\n    setSelectedPost(null);\r\n  };\r\n\r\n  const handleDeletePost = async (postId) => {\r\n    if (!window.confirm('Are you sure you want to delete this post?')) return;\r\n\r\n    try {\r\n      await axios.delete(`${API_BASE}/posts/${postId}`);\r\n      setPosts(prevPosts => prevPosts.filter(post => post.id !== postId));\r\n      setShowImageModal(false);\r\n      setSelectedPost(null);\r\n      alert('Post deleted successfully');\r\n    } catch (err) {\r\n      console.error('Error deleting post:', err);\r\n      alert('Failed to delete post');\r\n    }\r\n  };\r\n\r\n  const handleGetStarted = () => {\r\n    if (user) {\r\n      // Scroll to grid or something\r\n    } else {\r\n      setModalState({ isOpen: true, type: 'register' });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n      <Header\r\n        user={user}\r\n        searchQuery={searchQuery}\r\n        onSearch={handleSearch}\r\n        onUploadClick={() => setShowUpload(true)}\r\n        onLogout={() => {\r\n          setUser(null);\r\n          localStorage.removeItem('userId');\r\n          setSearchQuery('');\r\n          setCurrentPage(0);\r\n          setHasMore(true);\r\n          fetchPosts(0, false); // Reset to all posts on logout\r\n        }}\r\n        onLoginClick={() => setModalState({ isOpen: true, type: 'login' })}\r\n        onRegisterClick={() => setModalState({ isOpen: true, type: 'register' })}\r\n      />\r\n\r\n      {!user ? (\r\n        <Hero onGetStarted={handleGetStarted} />\r\n      ) : (\r\n        <MasonryGrid\r\n          posts={posts}\r\n          loading={loading}\r\n          hasMore={hasMore}\r\n          fetchMorePosts={fetchMorePosts}\r\n          onLike={handleLike}\r\n          onSave={handleSave}\r\n          onShare={handleShare}\r\n          onImageClick={handleImageClick}\r\n        />\r\n      )}\r\n\r\n      <Modals\r\n        isOpen={modalState.isOpen}\r\n        onClose={() => setModalState({ isOpen: false, type: modalState.type })}\r\n        type={modalState.type}\r\n        onSwitchType={(type) => setModalState({ isOpen: true, type })}\r\n        onLogin={handleLogin}\r\n        onRegister={handleRegister}\r\n      />\r\n\r\n      <UploadModal\r\n        isOpen={showUpload}\r\n        onClose={() => setShowUpload(false)}\r\n        onUpload={handleUpload}\r\n        user={user}\r\n      />\r\n\r\n      <ImageModal\r\n        post={selectedPost}\r\n        isOpen={showImageModal}\r\n        onClose={handleCloseImageModal}\r\n        onLike={handleLike}\r\n        onSave={handleSave}\r\n        onDelete={handleDeletePost}\r\n        user={user}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Home;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}